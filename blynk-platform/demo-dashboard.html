<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blynk IoT Platform - Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .demo-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            background: #22c55e;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .device-list {
            list-style: none;
        }

        .device-item {
            padding: 15px;
            background: #f8fafc;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }

        .device-name {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 5px;
        }

        .device-token {
            font-family: monospace;
            font-size: 0.85rem;
            color: #64748b;
            background: #e2e8f0;
            padding: 5px 10px;
            border-radius: 5px;
            display: inline-block;
        }

        .api-link {
            display: block;
            padding: 12px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 10px;
            transition: transform 0.2s;
        }

        .api-link:hover {
            transform: translateX(5px);
        }

        .endpoint {
            font-family: monospace;
            color: #667eea;
            font-weight: 600;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #64748b;
        }

        .error {
            background: #fee2e2;
            color: #991b1b;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #dc2626;
        }

        .success {
            background: #d1fae5;
            color: #065f46;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #10b981;
            margin-bottom: 20px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Blynk IoT Platform</h1>
            <p>Full-Scale IoT Dashboard & API System</p>
            <span class="demo-badge">DEMO MODE - Mock Data</span>
        </div>

        <div class="success" id="status">
            <strong>‚úÖ Backend API Server Running!</strong><br>
            Connected to: http://localhost:3000
        </div>

        <div class="grid">
            <!-- Devices Card -->
            <div class="card">
                <h2>
                    <span class="status-dot"></span>
                    Connected Devices
                </h2>
                <div id="devices-list" class="loading">Loading devices...</div>
            </div>

            <!-- Templates Card -->
            <div class="card">
                <h2>üìã Device Templates</h2>
                <div id="templates-list" class="loading">Loading templates...</div>
            </div>

            <!-- API Endpoints Card -->
            <div class="card">
                <h2>üîå API Endpoints</h2>
                <a href="http://localhost:3000/api" target="_blank" class="api-link">
                    üìñ API Documentation
                </a>
                <a href="http://localhost:3000/api/devices" target="_blank" class="api-link">
                    üì± Get Devices
                </a>
                <a href="http://localhost:3000/api/templates" target="_blank" class="api-link">
                    üìã Get Templates
                </a>
                <a href="http://localhost:3000/health" target="_blank" class="api-link">
                    üíö Health Check
                </a>
            </div>
        </div>

        <div class="card">
            <h2>üìä Platform Features</h2>
            <ul style="list-style: none; line-height: 2;">
                <li>‚úÖ <strong>Authentication System</strong> - JWT-based user auth</li>
                <li>‚úÖ <strong>Device Management</strong> - CRUD operations</li>
                <li>‚úÖ <strong>Template System</strong> - Reusable configurations</li>
                <li>‚úÖ <strong>Time-Series Database</strong> - PostgreSQL + TimescaleDB ready</li>
                <li>‚úÖ <strong>MQTT Integration</strong> - IoT device communication</li>
                <li>‚úÖ <strong>WebSocket Server</strong> - Real-time updates</li>
                <li>‚úÖ <strong>Docker Deployment</strong> - Production-ready</li>
                <li>üîÑ <strong>Automation Rules</strong> - Coming in Phase 3</li>
                <li>üîÑ <strong>Notifications</strong> - Coming in Phase 3</li>
                <li>üîÑ <strong>Analytics Dashboard</strong> - Coming in Phase 2</li>
            </ul>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3000';

        // Fetch devices
        async function loadDevices() {
            try {
                const response = await fetch(`${API_BASE}/api/devices`);
                const data = await response.json();

                if (data.devices && data.devices.length > 0) {
                    const html = `<ul class="device-list">
                        ${data.devices.map(device => `
                            <li class="device-item">
                                <div class="device-name">${device.name}</div>
                                <div class="device-token">Auth: ${device.authToken}</div>
                                <div style="margin-top: 8px; font-size: 0.85rem; color: #64748b;">
                                    Status: <strong style="color: ${device.status === 'online' ? '#22c55e' : '#64748b'}">${device.status}</strong>
                                </div>
                            </li>
                        `).join('')}
                    </ul>`;
                    document.getElementById('devices-list').innerHTML = html;
                } else {
                    document.getElementById('devices-list').innerHTML = '<p>No devices found</p>';
                }
            } catch (error) {
                document.getElementById('devices-list').innerHTML =
                    `<div class="error">Failed to load devices: ${error.message}</div>`;
            }
        }

        // Fetch templates
        async function loadTemplates() {
            try {
                const response = await fetch(`${API_BASE}/api/templates`);
                const data = await response.json();

                if (data.templates && data.templates.length > 0) {
                    const html = `<ul class="device-list">
                        ${data.templates.map(template => `
                            <li class="device-item">
                                <div class="device-name">${template.name}</div>
                                <div style="font-size: 0.85rem; color: #64748b;">
                                    Hardware: ${template.hardwareType}
                                </div>
                            </li>
                        `).join('')}
                    </ul>`;
                    document.getElementById('templates-list').innerHTML = html;
                } else {
                    document.getElementById('templates-list').innerHTML = '<p>No templates found</p>';
                }
            } catch (error) {
                document.getElementById('templates-list').innerHTML =
                    `<div class="error">Failed to load templates: ${error.message}</div>`;
            }
        }

        // Check server status
        async function checkStatus() {
            try {
                const response = await fetch(`${API_BASE}/health`);
                if (response.ok) {
                    document.getElementById('status').innerHTML = `
                        <strong>‚úÖ Backend API Server Running!</strong><br>
                        Connected to: ${API_BASE}
                    `;
                }
            } catch (error) {
                document.getElementById('status').innerHTML = `
                    <strong>‚ùå Backend Server Offline</strong><br>
                    Make sure demo-server.js is running on port 3000
                `;
                document.getElementById('status').classList.remove('success');
                document.getElementById('status').classList.add('error');
            }
        }

        // Load everything on page load
        window.addEventListener('load', () => {
            checkStatus();
            loadDevices();
            loadTemplates();
        });
    </script>
</body>

</html>